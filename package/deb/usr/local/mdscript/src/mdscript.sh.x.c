#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f deb/usr/local/mdscript/src/mdscript.sh -o deb/usr/bin/mdspt 
#endif

static  char data [] = 
#define      tst2_z	19
#define      tst2	((&data[1]))
	"\173\247\113\165\143\255\121\355\265\065\335\314\271\141\174\131"
	"\162\007\126\020"
#define      pswd_z	256
#define      pswd	((&data[32]))
	"\312\257\124\070\025\071\017\270\266\217\214\016\043\245\233\167"
	"\130\177\234\341\342\325\072\235\260\051\330\072\255\205\166\071"
	"\246\271\351\276\261\131\223\003\271\374\121\335\241\354\124\372"
	"\153\360\333\116\305\025\354\166\077\304\261\354\112\047\046\360"
	"\340\020\256\221\151\102\225\043\076\347\000\337\324\124\331\100"
	"\105\265\216\013\312\173\201\012\077\062\366\212\131\035\172\072"
	"\055\051\313\227\153\141\272\251\110\273\211\034\020\143\134\125"
	"\030\353\141\343\146\342\355\246\025\344\060\157\001\252\251\057"
	"\324\165\306\077\326\201\351\037\074\163\073\115\326\230\242\357"
	"\204\004\322\352\347\300\220\374\244\301\154\246\154\026\325\100"
	"\214\234\200\143\035\151\202\132\334\276\247\263\127\112\242\333"
	"\116\164\306\065\065\126\062\332\030\236\200\204\265\126\304\101"
	"\363\105\244\020\257\047\153\213\345\022\077\075\135\341\030\253"
	"\126\336\341\213\065\023\145\115\262\346\322\147\075\226\251\060"
	"\333\116\101\212\165\254\026\133\277\126\231\034\067\261\307\216"
	"\220\250\031\305\274\177\023\156\146\345\326\243\174\200\323\130"
	"\316\025\343\104\301\372\240\200\120\071\234\207\136\241\361\243"
	"\143\353\103\343\073\175\200\303\150\345\331\344"
#define      chk2_z	19
#define      chk2	((&data[304]))
	"\040\002\254\063\033\151\076\114\336\204\270\310\014\346\207\151"
	"\302\000\137"
#define      opts_z	1
#define      opts	((&data[323]))
	"\105"
#define      msg1_z	65
#define      msg1	((&data[337]))
	"\005\206\151\225\023\167\363\264\151\226\030\125\332\132\337\363"
	"\225\140\170\204\042\153\147\223\366\035\076\104\141\146\045\011"
	"\207\062\200\362\205\007\171\327\266\351\164\024\320\207\156\264"
	"\212\002\124\176\215\362\233\334\254\043\374\027\232\136\372\301"
	"\223\361\111\244\261\164\270\044\212\364\146\254\121\131\373\220"
	"\130\174\124\300\141\055\244\124\066"
#define      text_z	3141
#define      text	((&data[466]))
	"\103\007\274\366\014\102\140\241\125\327\225\012\101\054\042\226"
	"\007\036\047\137\233\173\040\374\251\305\121\340\217\142\317\322"
	"\152\213\311\166\316\051\030\044\001\256\056\102\333\121\331\342"
	"\160\000\102\014\174\125\124\242\043\334\203\076\364\115\163\210"
	"\136\253\053\366\247\242\275\022\322\132\056\161\125\263\326\360"
	"\100\005\350\134\303\032\053\136\270\224\303\162\130\263\153\304"
	"\050\064\164\044\206\311\116\143\233\236\066\134\062\127\010\024"
	"\043\241\375\246\170\357\211\062\166\261\156\036\245\075\245\325"
	"\003\317\064\013\011\143\020\026\225\011\332\242\046\175\201\123"
	"\313\263\023\044\020\150\023\242\171\270\006\066\314\257\050\335"
	"\271\231\256\317\302\305\025\045\060\070\220\204\005\233\206\163"
	"\271\215\247\270\131\234\276\266\357\164\153\127\152\106\032\344"
	"\355\022\210\104\321\121\243\255\035\001\262\012\066\034\054\056"
	"\137\072\140\110\205\261\242\333\336\320\040\152\003\314\031\315"
	"\177\322\141\325\226\372\151\204\101\006\332\136\363\324\007\344"
	"\310\252\060\130\335\232\277\374\024\220\307\206\340\022\045\370"
	"\332\123\071\106\237\247\030\352\045\342\042\324\305\010\332\114"
	"\115\233\134\073\320\010\231\143\143\246\037\217\037\220\243\144"
	"\263\152\276\336\150\044\355\343\263\047\130\052\363\102\301\034"
	"\224\037\220\003\125\162\371\362\211\132\054\106\003\126\033\206"
	"\000\271\323\344\257\346\174\301\323\210\370\305\072\113\376\354"
	"\377\016\324\162\343\301\354\141\044\322\343\044\036\052\177\367"
	"\336\047\204\044\126\020\271\014\010\123\352\101\200\177\256\154"
	"\122\317\266\176\350\145\171\056\251\105\257\362\065\040\061\150"
	"\026\032\065\042\235\363\200\236\121\073\276\074\373\260\161\173"
	"\116\336\165\157\100\115\060\036\300\164\065\034\156\073\034\171"
	"\046\234\016\012\231\344\174\207\034\276\152\335\141\220\353\301"
	"\041\114\263\075\051\217\001\356\064\033\256\014\172\024\131\021"
	"\114\204\221\200\020\377\041\314\250\112\077\127\176\017\327\352"
	"\325\272\002\231\103\312\123\356\347\315\363\372\007\105\127\245"
	"\246\030\301\216\115\276\264\262\012\036\320\161\103\030\271\304"
	"\114\213\303\113\141\361\320\336\131\252\225\252\162\050\157\247"
	"\306\117\247\332\340\103\305\271\343\075\217\347\024\253\156\001"
	"\040\302\204\226\170\336\312\014\343\256\116\167\023\346\040\057"
	"\241\000\102\070\103\050\304\004\010\105\130\322\145\211\204\321"
	"\272\235\036\336\341\121\013\042\035\362\115\074\277\217\303\252"
	"\137\333\152\261\055\320\141\214\314\046\040\202\364\271\151\365"
	"\314\046\017\212\303\275\007\072\130\164\232\222\006\275\021\240"
	"\067\242\242\103\046\125\151\167\067\026\035\137\023\107\210\264"
	"\176\236\142\346\101\345\377\244\117\122\177\011\343\123\335\274"
	"\206\116\262\156\005\366\041\362\142\204\332\026\360\052\306\177"
	"\016\374\152\041\114\337\106\161\350\043\020\300\024\375\304\252"
	"\044\215\347\072\164\325\263\232\045\123\116\106\006\154\050\163"
	"\260\023\060\256\153\216\122\270\030\344\300\026\005\165\000\225"
	"\355\363\225\115\032\060\072\365\322\330\100\040\031\021\316\314"
	"\036\211\366\373\361\012\130\231\114\031\212\214\143\125\346\335"
	"\251\346\357\112\320\357\270\033\112\317\155\277\075\275\260\113"
	"\112\104\023\024\045\255\151\315\222\332\162\154\016\205\023\123"
	"\276\325\127\000\061\133\334\006\364\216\033\101\004\161\117\111"
	"\025\036\036\020\331\317\243\122\203\261\316\106\014\016\256\062"
	"\130\104\070\065\057\300\161\170\070\372\145\342\116\154\071\132"
	"\003\226\355\350\111\324\067\146\246\067\345\261\203\307\166\334"
	"\374\156\370\343\334\244\231\205\051\072\075\042\242\262\105\302"
	"\050\124\307\325\115\224\017\342\016\145\174\153\030\210\125\221"
	"\112\252\221\245\344\015\214\127\155\325\153\013\326\101\034\117"
	"\016\353\000\326\066\310\247\176\356\350\151\145\217\160\122\142"
	"\240\011\121\155\235\322\224\017\303\050\210\266\207\375\105\334"
	"\207\263\344\052\100\275\045\107\016\266\124\035\065\003\014\041"
	"\224\306\323\346\233\145\211\070\244\236\230\022\147\307\177\275"
	"\231\124\340\204\321\174\130\121\103\065\126\206\362\220\155\100"
	"\071\337\263\120\366\343\165\366\305\147\011\124\131\303\247\275"
	"\002\123\226\007\222\261\156\043\247\330\360\265\102\055\067\053"
	"\165\250\337\356\103\226\357\131\110\113\061\242\076\023\256\362"
	"\253\025\206\227\130\205\302\377\226\324\147\327\226\074\074\047"
	"\361\327\030\120\232\345\201\264\015\015\206\117\031\034\264\155"
	"\011\117\337\235\041\170\245\235\173\333\215\136\005\032\125\021"
	"\256\020\043\004\162\111\042\316\326\355\015\246\163\026\365\371"
	"\331\350\276\153\137\036\243\044\372\153\222\014\325\051\262\075"
	"\045\374\022\234\027\101\365\013\200\200\011\154\176\071\370\136"
	"\165\171\261\162\303\112\171\056\340\067\221\111\150\144\365\075"
	"\223\066\176\326\120\033\236\162\030\132\111\241\322\205\177\132"
	"\135\370\370\111\036\042\141\306\336\131\070\033\275\327\027\022"
	"\170\230\235\174\176\223\155\101\220\106\333\064\047\062\230\304"
	"\332\343\013\145\324\162\242\160\365\371\367\360\120\022\252\035"
	"\171\056\237\277\252\135\351\102\373\332\075\260\217\121\222\051"
	"\374\346\037\345\331\015\346\277\301\025\167\333\004\371\174\141"
	"\310\201\265\256\263\200\330\154\076\164\350\267\167\141\357\302"
	"\145\374\064\353\372\014\000\213\255\377\121\213\207\223\324\162"
	"\170\244\246\272\077\077\066\313\173\305\040\262\130\131\335\050"
	"\066\225\311\226\044\264\356\025\364\117\367\010\167\333\355\361"
	"\340\030\133\035\346\135\034\227\070\270\302\200\363\004\141\376"
	"\254\061\204\022\342\247\053\051\330\073\174\037\317\357\010\132"
	"\253\265\333\353\243\026\057\000\003\012\055\146\307\034\053\112"
	"\000\254\040\157\167\221\333\116\372\371\342\211\175\115\077\207"
	"\157\245\131\377\143\205\236\367\074\220\313\231\164\154\164\217"
	"\103\342\144\311\006\023\177\233\013\100\106\101\043\004\043\352"
	"\064\171\100\317\250\072\156\001\036\314\363\152\263\205\274\076"
	"\020\234\070\371\230\174\270\200\310\104\037\227\265\066\322\355"
	"\162\104\302\043\070\220\126\240\257\154\047\357\137\265\111\331"
	"\164\322\017\040\301\002\000\306\121\233\044\053\211\161\255\102"
	"\226\054\263\100\105\307\147\231\135\171\335\162\106\057\111\067"
	"\044\374\221\225\336\001\272\046\104\056\366\176\363\370\040\022"
	"\200\226\213\017\255\007\365\255\354\333\116\037\366\304\016\045"
	"\333\336\160\163\352\047\170\376\000\215\171\046\022\341\326\304"
	"\367\021\125\021\010\204\231\263\141\231\203\377\104\024\136\167"
	"\027\117\120\130\006\343\015\173\351\362\210\256\052\317\214\046"
	"\375\076\175\315\015\104\212\234\140\100\015\251\252\305\204\310"
	"\376\234\320\351\312\217\203\167\310\332\046\224\234\212\061\042"
	"\113\007\004\160\167\061\337\076\202\274\035\227\051\147\154\130"
	"\006\252\073\371\263\015\077\207\373\133\003\122\215\047\075\046"
	"\364\351\204\376\350\012\001\263\162\326\217\264\255\205\341\210"
	"\052\226\036\166\253\143\231\325\355\350\112\052\237\167\012\066"
	"\235\033\373\124\021\226\254\060\152\100\320\265\121\364\042\350"
	"\156\271\035\104\152\367\041\267\216\377\375\374\002\000\144\337"
	"\163\161\110\336\256\153\045\070\237\116\255\222\032\065\376\051"
	"\025\030\223\120\341\157\302\137\047\273\015\117\307\276\172\077"
	"\151\357\300\327\164\201\262\167\207\134\274\116\337\225\345\140"
	"\236\130\042\122\261\310\001\240\354\043\355\340\347\127\243\260"
	"\010\244\357\376\214\002\023\267\070\140\366\233\371\331\227\376"
	"\063\147\077\356\140\275\004\363\314\230\370\245\352\365\214\152"
	"\375\142\150\240\257\060\367\355\122\231\160\225\362\220\362\003"
	"\123\321\075\051\344\242\225\375\052\011\244\352\241\050\115\107"
	"\007\371\071\174\014\121\336\274\314\210\020\000\332\303\033\002"
	"\350\174\120\021\230\370\275\034\345\277\103\034\307\356\213\217"
	"\370\151\232\300\366\351\202\066\171\164\104\147\051\066\074\231"
	"\271\335\205\074\075\270\340\160\050\250\267\241\211\077\317\003"
	"\323\073\213\074\217\367\125\036\362\161\030\162\030\321\165\073"
	"\264\371\022\322\320\021\042\346\075\370\051\177\057\222\024\074"
	"\230\332\217\060\217\204\340\270\117\234\062\376\047\165\374\307"
	"\235\226\330\375\163\263\173\054\136\160\126\142\230\243\342\151"
	"\126\301\147\042\050\343\052\075\313\374\210\315\166\301\273\340"
	"\071\366\141\045\262\031\317\263\010\047\036\326\332\114\357\363"
	"\161\133\134\356\346\326\316\057\023\247\256\354\237\112\373\074"
	"\157\321\325\315\370\231\062\237\275\310\115\114\227\272\070\103"
	"\237\375\207\247\071\141\256\243\050\147\313\155\012\141\054\022"
	"\036\005\310\173\126\233\156\271\074\227\252\174\037\132\245\001"
	"\141\321\213\075\106\123\254\313\205\305\132\272\051\201\254\355"
	"\344\055\112\322\241\336\152\152\074\175\020\031\217\014\301\330"
	"\357\114\076\030\345\224\247\305\353\352\155\207\021\154\113\174"
	"\071\350\165\311\246\335\076\312\137\216\226\146\227\034\152\251"
	"\062\224\133\302\217\046\220\306\116\030\120\147\254\250\220\012"
	"\122\051\074\022\306\311\237\147\263\227\263\121\316\270\354\122"
	"\220\200\100\307\131\161\124\063\123\257\177\131\273\326\336\057"
	"\073\172\331\033\100\046\274\050\237\121\340\235\361\301\241\014"
	"\232\306\361\371\273\255\134\110\243\210\014\043\317\322\111\063"
	"\230\230\123\360\146\275\231\073\066\376\207\372\353\031\311\267"
	"\226\047\312\145\042\342\266\363\116\072\373\237\232\161\162\246"
	"\141\155\262\023\223\254\344\034\240\207\044\017\366\052\216\121"
	"\137\131\147\004\257\052\206\360\364\142\021\137\257\063\013\070"
	"\301\204\010\102\131\125\301\330\067\325\216\343\177\024\005\210"
	"\177\136\001\374\106\152\151\371\161\167\121\314\240\161\217\320"
	"\053\117\062\316\014\112\170\116\043\035\035\314\140\373\013\114"
	"\232\361\002\152\265\150\017\177\346\353\147\032\120\155\070\263"
	"\217\002\340\143\070\030\040\056\204\227\033\023\030\243\257\300"
	"\162\147\252\211\276\046\104\177\155\335\063\315\217\201\164\334"
	"\233\105\162\146\347\207\365\267\255\274\277\242\176\325\376\202"
	"\246\156\335\206\130\310\363\201\142\152\220\371\146\357\013\161"
	"\317\156\072\157\223\031\323\016\110\203\346\014\303\300\343\200"
	"\367\025\123\323\030\107\130\174\310\035\130\232\113\110\374\177"
	"\364\352\363\371\167\065\201\076\127\276\156\235\036\106\346\356"
	"\152\343\001\121\341\341\261\302\052\210\346\175\352\122\043\317"
	"\127\071\246\254\223\112\255\140\327\217\221\277\053\062\366\240"
	"\161\034\053\307\123\170\063\360\046\046\021\275\174\300\302\011"
	"\247\337\027\317\234\151\276\131\362\064\160\332\066\252\144\141"
	"\366\311\075\204\351\121\240\164\070\171\302\046\305\157\361\024"
	"\144\373\303\265\126\042\042\172\154\252\066\031\163\025\117\014"
	"\106\166\246\152\157\370\315\257\031\133\055\037\036\236\170\152"
	"\335\340\244\156\055\267\372\203\166\105\223\364\210\015\145\011"
	"\305\272\203\122\326\173\342\371\102\037\012\175\126\220\103\010"
	"\235\105\245\156\256\204\252\367\000\317\001\061\267\124\057\103"
	"\300\327\357\315\060\361\306\036\177\057\052\126\202\116\332\170"
	"\235\161\254\213\310\007\232\377\250\227\001\074\152\205\165\223"
	"\027\165\132\310\336\373\240\060\135\100\243\030\122\325\127\374"
	"\276\063\235\143\275\326\025\231\132\361\027\132\062\242\144\035"
	"\227\156\226\305\010\043\330\040\174\130\327\365\263\342\334\102"
	"\110\055\003\333\257\077\274\073\042\076\340\011\053\267\351\067"
	"\203\034\103\174\217\021\307\040\043\365\266\045\030\207\246\051"
	"\077\036\346\033\164\001\346\132\020\032\144\322\131\170\057\331"
	"\013\320\304\242\377\325\327\223\325\236\173\273\150\362\353\277"
	"\072\275\212\200\226\000\362\267\000\052\340\371\017\105\153\010"
	"\235\061\074\260\003\241\341\153\374\172\024\251\125\124\271\005"
	"\245\161\221\216\171\206\303\105\222\273\273\353\264\023\366\017"
	"\014\362\342\140\155\067\022\103\146\261\211\043\145\225\142\127"
	"\005\250\036\346\023\266\210\310\316\346\276\300\240\077\371\226"
	"\047\017\307\130\370\211\165\144\031\051\351\313\145\177\012\374"
	"\227\267\163\211\341\307\235\307\252\246\320\127\225\362\013\251"
	"\004\226\302\150\321\107\206\243\007\053\223\157\331\335\101\077"
	"\206\104\212\020\220\023\325\172\230\302\030\356\057\112\360\334"
	"\020\031\326\075\321\167\226\161\314\065\343\340\155\105\111\250"
	"\002\305\107\215\144\037\206\134\005\171\206\340\136\371\250\305"
	"\362\073\250\304\016\152\143\002\170\060\117\351\155\310\007\227"
	"\322\011\335\056\311\122\337\333\051\251\202\352\370\024\314\201"
	"\042\324\231\361\146\172\211\032\052\353\353\357\251\174\263\057"
	"\253\353\064\304\147\030\265\363\305\373\264\011\025\241\022\231"
	"\155\230\161\177\154\141\227\167\242\312\200\345\354\023\300\263"
	"\153\323\336\246\030\124\361\103\100\333\303\202\174\305\105\302"
	"\003\203\061\321\147\316\205\264\263\160\357\131\314\312\201\356"
	"\354\053\012\234\234\322\262\077\350\034\251\061\362\101\223\133"
	"\346\336\117\041\327\257\346\266\320\346\221\330\102\071\135\076"
	"\064\274\132\067\106\145\320\332\142\020\003\176\114\006\137\334"
	"\331\001\265\146\344\256\265\043\032\014\266\235\153\354\137\177"
	"\277\342\127\215\340\310\027\166\336\027\266\123\046\102\112\005"
	"\070\174\242\072\322\073\166\323\224\077\373\045\364\114\223\101"
	"\030\221\031\327\025\342\364\172\003\367\246\053\353\217\107\356"
	"\167\346\314\200\231\152\177\227\141\073\114\344\072\311\065\235"
	"\121\023\306\340\370\257\031\376\005\323\155\000\043\021\055\155"
	"\162\256\025\230\130\355\357\353\111\025\353\143\110\005\315\334"
	"\244\313\043\107\365\362\156\201\243\366\107\317\024\063\041\132"
	"\262\023\205\343\270\131\153\353\172\166\221\247\373\310\167\204"
	"\350\173\367\134\003\356\120\022\374\062\142\010\046\050\132\006"
	"\267\274\325\212\047\141\123\235\057\175\266\123\176\145\202\301"
	"\100\324\232\043\105\233\145\121\027\310\132\075\360\264\104\250"
	"\161\032\062\230\173\206\066\253\003\355\377\202\122\201\103\222"
	"\126\336\266\233\172\033\354\222\343\106\320\324\373\024\174\154"
	"\056\257\004\252\065\073\125\071\050\125\273\172\326\377\015\055"
	"\336\303\310\130\336\265\352\302\374\272\227\367\317\024\143\375"
	"\303\150\250\371\243\376\062\313\123\356\105\052\356\122\127\314"
	"\026\037\045\364\325\017\267\321\312\116\310\232\143\053\227\047"
	"\224\100\040\067\076\123\003\221\102\110\273\060\233\022\374\261"
	"\062\041\246\007\061\136\330\374\255\241\226\020\314\056\067\141"
	"\156\130\230\255\253\233\076\356\344\372\036\200\015\033\062\077"
	"\074\331\107\156\067\040\153\344\301\001\365\216\060\055\357\237"
	"\205\207\114\061\043\213\037\010\205\076\211\223\131\273\323\226"
	"\224\032\005\314\072\160\261\373\162\247\211\242\324\171\102\131"
	"\000\216\213\044\032\253\055\240\351\266\063\102\162\006\331\006"
	"\041\336\323\133\116\204\127\301\054\341\144\000\132\246\132\133"
	"\065\346\200\117\221\255\357\173\144\043\275\326\051\227\335\112"
	"\165\260\246\304\065\375\205\141\337\351\142\071\220\274\224\306"
	"\242\024\025\063\302\005\256\046\051\154\374\122\003\331\235\171"
	"\212\104\075\300\102\303\041\041\255\203\132\075\100\357\003\342"
	"\004\031\026\306\037\305\355\110\062\352\233\066\303\071\257\116"
	"\175\355\016\300\260\060\341\136\264\074\234\365\054\240\327\060"
	"\271\356\367\331\264\345\041\346\317\275\034\223\366\314\341\164"
	"\271\360\064\152\041\025\310\325\122\144\313\176\004\242\257\276"
	"\221\247\227\105\214\271\053\133\167\110\356\155\024\320\342\315"
	"\300\026\070\342\054\000\270\176\145\203\375\151\046\254\050\267"
	"\124\300\375\340\171\050\073\360\161\052\136\205\372\100\123\273"
	"\127\213\235\203\213\126\002\360\331\377\132\377\254\202\267\000"
	"\102\264\341\274\334\035\255\116\107\014\323\102\114\046\376\244"
	"\261\234\047\074\362\052\055\313\052\207\313\327\012\202\327\114"
	"\066\271\011\023\326\266\141\035\302\064\140\017\133\136\263\014"
	"\372\333\111\354\006\166\270\060\376\203\007\010\005\337\125\073"
	"\231\136\117\157\025\260\215\327\345\355\347\100\113\233\114\106"
	"\167\226\062\175\015\352\256\013\156\266\024\163\226\152\257\057"
	"\310\376\236\335\256\053\265\223\030\235\324\144\070\040\252\257"
	"\267\335\055\304\310\334\320\066\222\345\251\050\117\130\127\027"
	"\127\366\365\006\041\253\231\072\110\156\237\201\216\111\060\106"
	"\047\136\012\357\072\333\045\315\300\317\365\017\050\115\047\177"
	"\103\035\205\145\310\037\240\021\215\100\222\034\212\303\142\261"
	"\041\155\240\134\110\306\051\010\226\037\030\276\154\077\076\260"
	"\134\304\026\045\344\267\066\161\367\310\216\201\213\361\062\254"
	"\137\323\011\247\232\062\260\060\122\310\357\276\007\055\157\144"
	"\361\206\211\325\075\277\107\065\207\326\266\023\307\351\277\046"
	"\274\311\316\127\373\176\207\116\107\166\014\117\243\174\263\225"
	"\003\074\153\100\374\263\165\204\211\054\227\121\025\127\170\322"
	"\040\107\051\034\306\260\152"
#define      date_z	1
#define      date	((&data[4340]))
	"\002"
#define      xecc_z	15
#define      xecc	((&data[4344]))
	"\017\140\367\271\127\124\301\316\257\061\346\076\252\121\263\234"
	"\054\103\114\314\070"
#define      inlo_z	3
#define      inlo	((&data[4362]))
	"\133\117\223"
#define      shll_z	10
#define      shll	((&data[4365]))
	"\037\266\271\241\327\265\316\377\136\251\144\133"
#define      lsto_z	1
#define      lsto	((&data[4377]))
	"\356"
#define      tst1_z	22
#define      tst1	((&data[4383]))
	"\353\370\341\234\143\354\260\306\337\347\234\043\107\351\107\272"
	"\221\352\075\026\113\215\350\340\370\000\252"
#define      chk1_z	22
#define      chk1	((&data[4409]))
	"\113\217\316\132\034\323\175\037\156\011\007\156\243\205\157\257"
	"\210\154\121\213\142\231\311\024\327\051\360\306\247\274\376"
#define      msg2_z	19
#define      msg2	((&data[4437]))
	"\276\377\143\071\221\266\106\336\257\257\141\025\366\007\173\300"
	"\154\244\141\066\106\206\043"
#define      rlax_z	1
#define      rlax	((&data[4459]))
	"\345"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
